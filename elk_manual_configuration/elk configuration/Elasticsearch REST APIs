# REST APIs

## Cluster APIs

    ### If no filters are given, the default is to select all nodes
    GET /_nodes

    #### https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-info.html

    ### Select the elected master node
    GET /_nodes/_master

    
    ### Get cluster health
    
    GET /_cluster/health

    ####  https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-health.html



## Index APIs

    ### Create an Index   
PUT /my_index
{
  "settings": {
    "number_of_shards": 1
  },
  "mappings": {
    "properties": {
      "rank": {"type": "text"},
      "tier": {"type": "text"},
      "username": {"type": "text"}
    }
  }
}
    
    ####Mapping is the process of defining how a document, and the fields it contains, are stored and indexed.
    #### https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-create-index.html#indices-create-api-query-params


## Creating a document
#### You can index a new JSON document with the _doc or _create resource. Using _create guarantees that the document is only indexed if it does not already exist. To update an existing document, you must use the _doc resource.


PUT /my_index/_doc/1
{
  
    "rank": "1", 
    "tier": "champ",
    "username": "pcs"

}

#### To update document with id 1



PUT /my_index/_doc/1
{
  
    "rank": "1", 
    "tier": "champ",
    "username": "jfk"

}

Add bulk 


POST _bulk
{ "index" : { "_index" : "my_index", "_id" : "2" } }
{ "rank" : "1", "tier": "champ", "username": "pcs" }
{ "index" : { "_index" : "my_index", "_id" : "3" } }
{ "rank" : "2", "tier": "champ", "username": "v2y" }
{ "index" : { "_index" : "my_index", "_id" : "4" } }
{ "rank" : "3", "tier": "champ", "username": "ddx" }


Using a file
cat json_data.json 
{ "index" : { "_index" : "csv_index", "_id" : "4" } }
{ "rank" : "4", "tier": "champ", "username": "t1k" }
{ "index" : { "_index" : "csv_index", "_id" : "5" } }
{ "rank" : "5", "tier": "champ", "username": "v4z" }
{ "index" : { "_index" : "csv_index", "_id" : "6" } }
{ "rank" : "6", "tier": "champ", "username": "g5j" }


curl -s -H "Content-Type: application/json" -XPOST http://localhost:9200/_bulk --data-binary "@json_data.json"


# Retrieve a document 


GET csv_index/_doc/1



# Search APIs -> Query DSL

wildcard search 

Returns documents that contain terms matching a wildcard pattern.

A wildcard operator is a placeholder that matches one or more characters. For example, the * wildcard operator matches zero or more characters. You can combine wildcard operators with other characters to create a wildcard pattern.

 
GET /csv_index/_search
{
  "query": {
    "wildcard": {
      "username": {
        "value": "p*"
        
      }
  }
}}

Term Query
GET /_search
{
  "query": {
    "term": {
      "username": {
        "value": "v2y",
      }
    }
  }
}

Exists queryedit
Returns documents that contain an indexed value for a field.

An indexed value may not exist for a documentâ€™s field due to a variety of reasons:


GET /_search
{
  "query": {
    "exists": {
      "field": "user*"
    }
  }
}


DELETE a document
DELETE csv_index/_doc/1

DELETE BY Query
POST csv_index/_delete_by_query 
{
  "query": {
    "term": {
      "username": {
        "value": "v2y"
      }
    }
  }
}

Usage API

GET /_xpack/usage






